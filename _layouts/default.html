<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title | default: site.title }}</title>
    <link rel="stylesheet" href="{{ "/assets/css/style.css" | relative_url }}">
    <style>
        /* === CSS for the "Don't Push This" Button Scare Effect === */
        .silly-button-container {
          margin-left: 20px; 
        }
        #dont-push-button {
          background-color: #ffc107; 
          color: #333; 
          border: 1px solid #d39e00; 
          padding: 3px 8px; 
          font-size: 0.75em; 
          border-radius: 4px; 
          cursor: pointer; 
          box-shadow: 1px 1px 3px rgba(0,0,0,0.2); 
          transition: background-color 0.2s ease; 
        }
        #dont-push-button:hover {
          background-color: #e0a800; 
        }
        .silly-image-popup {
          display: none; 
          position: fixed; 
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: transparent; 
          z-index: 999; 
          pointer-events: none; 
        }
        #silly-image {
          position: fixed; 
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%) scale(0.1); 
          opacity: 0; 
          max-width: 90vw; 
          max-height: 90vh; 
          object-fit: contain; 
          border: 4px solid white; 
          box-shadow: 0 0 35px rgba(0,0,0,0.7); 
          z-index: 1000; 
          transition: transform 0.15s ease-in, 
                      opacity 0.1s ease-in;   
          pointer-events: none; 
        }
        #silly-image.visible {
          transform: translate(-50%, -50%) scale(3.5); 
          opacity: 1; 
        }

        /* === Homepage GIF Animation (Diagonal Run) === */
        /* --- TUNABLE (CSS): Keyframes for Diagonal Movement --- */
        /* Adjust translateX and translateY percentages for different angles/distances */
        @keyframes run-diagonally {
          0% {
            /* Start off-screen bottom-left */
            transform: translate(-150px, 100px); /* -X for left, +Y for down (relative to bottom:0) */
            opacity: 1;
          }
          100% {
            /* End off-screen top-right */
            /* '100vw' ensures it goes fully across the width */
            /* '-100vh' makes it go significantly upwards. Adjust for desired height. */
            transform: translate(100vw, -80vh); 
            opacity: 1;
          }
        }

        .running-dog-gif {
          position: fixed; 
          /* --- TUNABLE (CSS): Initial starting position (bottom-left corner) --- */
          bottom: 0px;    /* Start at the very bottom */
          left: 0;         
          transform: translate(-150px, 100px); /* Initial off-screen position (matches keyframe 0%) */
          
          /* --- TUNABLE (CSS): GIF Size --- */
          width: 120px;    
          height: auto;    
          
          z-index: 500;    
          
          /* --- TUNABLE (CSS): Animation properties --- */
          animation-name: run-diagonally;
          animation-duration: 6s; /* Example: 6 seconds to run diagonally */
          animation-timing-function: linear; /* Constant speed */
          animation-iteration-count: 1; /* Runs once */
          animation-delay: 0.5s; /* Starts 0.5 seconds after page load */
          
          pointer-events: none; 
          opacity: 0; /* Start hidden, animation will make it visible if keyframes include opacity */
        }
        /* Make it visible when animation starts if opacity is used in keyframes */
        .running-dog-gif.animate {
            opacity: 1; /* Or manage opacity within keyframes */
        }

    </style>
</head>
<body>
    <header>
        <h1>{{ site.title }}</h1>
        <nav>
            <a href="{{ "/" | relative_url }}" {% if page.url == "/" %}class="active"{% endif %}>Home</a>
            <a href="{{ "/photos/" | relative_url }}" {% if page.url == "/photos/" or page.url contains "/albums/" %}class="active"{% endif %}>Photos</a>
            <a href="{{ "/blog/" | relative_url }}" {% if page.url == "/blog/" or page.layout == "post" %}class="active"{% endif %}>Blog</a>
            <a href="{{ "/recipes/" | relative_url }}" {% if page.url == "/recipes/" or page.url == "/tags/" or page.layout == "recipe" or page.layout == "tag_page" %}class="active"{% endif %}>Recipes</a>
        </nav>
    </header>

    <main>
        <div class="content-wrapper">
            {{ content }}
        </div>
    </main>

    <footer>
        <span>&copy; 2024 Finley Family</span>
        <div class="silly-button-container">
          <button id="dont-push-button">Don't push this</button>
          <div id="silly-image-popup" class="silly-image-popup" style="display: none;">
            <img id="silly-image" src="" alt="Surprise!"> {# src will be set by JavaScript #}
          </div>
        </div>
    </footer>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        
        // --- Logic for "Don't Push This" Button (Single Spooky GIF) ---
        const sillyButton = document.getElementById('dont-push-button');
        const sillyPopup = document.getElementById('silly-image-popup'); 
        const sillyImage = document.getElementById('silly-image');     
        let isShowingSillyImage = false; 

        // --- REVERTED: Single GIF Path ---
        // IMPORTANT: Replace 'your-spooky-gif.gif' with your actual spooky GIF's filename
        // Make sure the GIF is in your 'assets/images/' folder.
        const spookyImageSrc = "{{ '/assets/images/your-spooky-gif.gif' | relative_url }}"; 

        if (sillyButton && sillyPopup && sillyImage) {
          sillyButton.addEventListener('click', function() {
            if (isShowingSillyImage) return; 
            isShowingSillyImage = true;

            // Set the single GIF source
            sillyImage.src = spookyImageSrc + "?t=" + new Date().getTime(); 

            sillyPopup.style.display = 'flex'; 

            const delayBeforeExpansion = 20; 
            setTimeout(function() {
              sillyImage.classList.add('visible'); 
            }, delayBeforeExpansion); 

            const durationImageStaysExpanded = 300; 
            setTimeout(function() {
              sillyImage.classList.remove('visible'); 

              const cssTransformDuration = 150; 
              setTimeout(function() {
                sillyPopup.style.display = 'none'; 
                isShowingSillyImage = false; 
              }, cssTransformDuration);

            }, durationImageStaysExpanded); 
          });
        }

        // --- Logic for Homepage Running Dog GIF (Diagonal Run) ---
        const isHomePage = window.location.pathname === '{{ site.baseurl }}/' || window.location.pathname === '{{ site.baseurl }}/index.html';
        
        if (isHomePage) {
          const dogGifElement = document.createElement('img');
          // --- TUNABLE (JS): Path to your running dog GIF ---
          const runningDogGifSrc = "{{ '/assets/images/running-dog.gif' | relative_url }}"; 
          
          // --- TUNABLE (JS): Match these to your CSS animation durations/delays ---
          const cssAnimationRunDuration = 6000; // Duration of CSS animation (e.g., 6s = 6000ms)
          const cssAnimationStartDelay = 500;  // Delay before CSS animation starts (e.g., 0.5s = 500ms)

          dogGifElement.src = runningDogGifSrc + "?t=" + new Date().getTime(); 
          dogGifElement.alt = "Running dog animation";
          dogGifElement.classList.add('running-dog-gif'); 

          // Add the dog GIF to the page then trigger animation by adding a class
          setTimeout(function() {
              document.body.appendChild(dogGifElement);
              // Add a class to trigger opacity change if managed by CSS, or just rely on keyframes
              // For simplicity, we'll assume keyframes handle opacity or it starts visible.
              // If opacity is 0 initially in .running-dog-gif, add a class here to make it 1.
              dogGifElement.classList.add('animate'); // If you use this, ensure .running-dog-gif.animate { opacity: 1; }

              // Remove the dog GIF element after its animation is complete
              // Total time = animation duration itself
              setTimeout(function() {
                  if (dogGifElement.parentNode) { 
                      dogGifElement.parentNode.removeChild(dogGifElement);
                  }
              }, cssAnimationRunDuration); 
          }, cssAnimationStartDelay);
        }
        // --- End Homepage Running Dog GIF ---

      }); // End of DOMContentLoaded listener
    </script>
</body>
</html>
